<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線上測驗</title>
    <style>
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f4f4f9; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        .student-info { margin-bottom: 20px; padding: 15px; background-color: #e9ecef; border-radius: 5px; }
        .student-info label { display: block; margin-bottom: 5px; font-weight: bold; }
        .student-info input { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; }
        .question { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px dashed #ccc; }
        .question h3 { margin-bottom: 10px; font-size: 1.1em; color: #2c3e50; }
        .options label { display: block; margin-bottom: 8px; cursor: pointer; }
        .options input[type="radio"] { margin-right: 10px; }
        .input-answer { margin-top: 10px; }
        .btn-submit { display: block; width: 100%; padding: 15px; background-color: #28a745; color: white; border: none; font-size: 1.2em; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
        .btn-submit:hover { background-color: #218838; }
        #result-area { margin-top: 30px; display: none; text-align: center; }
        .score-display { font-size: 2em; font-weight: bold; color: #d9534f; }
        .btn-mail { background-color: #007bff; margin-top: 15px; }
        .btn-mail:hover { background-color: #0069d9; }
    </style>
</head>
<body>

<div class="container">
    
    <div class="student-info">
        <label for="studentClass">班級：</label>
        <input type="text" id="studentClass" placeholder="例如：701">
        <label for="studentName">姓名：</label>
        <input type="text" id="studentName" placeholder="請輸入您的姓名">
        <label for="studentNo">座號：</label>
        <input type="text" id="studentNo" placeholder="請輸入座號">
    </div>

    <form id="quizForm">
        <div class="question" id="q1">
            <h3>1. 化簡 13 - 5x - 8 + 7x = ?</h3>
            <div class="options">
                <label><input type="radio" name="q1" value="A"> 2x + 21</label>
                <label><input type="radio" name="q1" value="B"> 2x + 5</label>
                <label><input type="radio" name="q1" value="C"> 12x + 5</label>
                <label><input type="radio" name="q1" value="D"> -12x + 21</label>
            </div>
        </div>

        <div class="question" id="q2">
            <h3>2. 解方程式：6 = x + 35，則 x = ?</h3>
            <div class="options">
                <label><input type="radio" name="q2" value="A"> 41</label>
                <label><input type="radio" name="q2" value="B"> 29</label>
                <label><input type="radio" name="q2" value="C"> -29</label>
                <label><input type="radio" name="q2" value="D"> -41</label>
            </div>
        </div>

        <div class="question" id="q3">
            <h3>3. 解方程式：8x + 4 = 3x + 29，則 x = ?</h3>
            <div class="options">
                <label><input type="radio" name="q3" value="A"> 5</label>
                <label><input type="radio" name="q3" value="B"> -5</label>
                <label><input type="radio" name="q3" value="C"> 7</label>
                <label><input type="radio" name="q3" value="D"> 33/11</label>
            </div>
        </div>

        <div class="question" id="q4">
            <h3>4. 解方程式：4x = 9x + 100，則 x = ?</h3>
            <div class="options">
                <label><input type="radio" name="q4" value="A"> 20</label>
                <label><input type="radio" name="q4" value="B"> -20</label>
                <label><input type="radio" name="q4" value="C"> 25</label>
                <label><input type="radio" name="q4" value="D"> -25</label>
            </div>
        </div>

        <div class="question" id="q5">
            <h3>5. 解方程式：2(x - 3) - 3(2x + 1) = 3</h3>
            <div class="options">
                <label><input type="radio" name="q5" value="A"> x = -1</label>
                <label><input type="radio" name="q5" value="B"> x = -2</label>
                <label><input type="radio" name="q5" value="C"> x = -3</label>
                <label><input type="radio" name="q5" value="D"> x = 3</label>
            </div>
        </div>

        <div class="question" id="q6">
            <h3>6. 解方程式：5/8 x = -8 3/4 (負八又四分之三)，則 x = ?</h3>
            <div class="options">
                <label><input type="radio" name="q6" value="A"> -12</label>
                <label><input type="radio" name="q6" value="B"> -14</label>
                <label><input type="radio" name="q6" value="C"> -10</label>
                <label><input type="radio" name="q6" value="D"> -15</label>
            </div>
        </div>

        <div class="question" id="q7">
            <h3>7. 下列何者是方程式 6x = 3x 的解？</h3>
            <div class="options">
                <label><input type="radio" name="q7" value="A"> x = 0</label>
                <label><input type="radio" name="q7" value="B"> x = 2</label>
                <label><input type="radio" name="q7" value="C"> x = 1/2</label>
                <label><input type="radio" name="q7" value="D"> 無解</label>
            </div>
        </div>

        <div class="question" id="q8">
            <h3>8. 桃樂絲帶 x 元去買甜點，全買剉冰可買 30 碗，全買豆花可買 40 碗。已知豆花每碗比剉冰便宜 5 元，依題意可列出下列哪一個方程式？</h3>
            <div class="options">
                <label><input type="radio" name="q8" value="A"> x/30 = x/40 + 5</label>
                <label><input type="radio" name="q8" value="B"> x/30 = (x+5)/40</label>
                <label><input type="radio" name="q8" value="C"> x/40 = x/30 + 5</label>
                <label><input type="radio" name="q8" value="D"> x/40 = (x+5)/30</label>
            </div>
        </div>

        <div class="question" id="q9">
            <h3>9. 土匪老師去便利商店買冰拿鐵。已知每杯 50 元，店員說：「如果再多買 3 杯就可以打 8 折，價錢只比現在多 40 元。」土匪老師最後接受建議多買了3杯。請問土匪老師最後「共買了」幾杯冰拿鐵？</h3>
            <div class="options">
                <label><input type="radio" name="q9" value="A"> 8 杯</label>
                <label><input type="radio" name="q9" value="B"> 11 杯</label>
                <label><input type="radio" name="q9" value="C"> 14 杯</label>
                <label><input type="radio" name="q9" value="D"> 17 杯</label>
            </div>
        </div>

         <div class="question" id="q10">
            <h3>10. 小紅帽說：「六年前媽媽的年齡是我的一半再多 24 歲，六年後媽媽的年齡剛好是我的 8 倍。」關於這段話，下列敘述何者正確？</h3>
            <div class="options">
                <label><input type="radio" name="q10" value="A"> 條件過少，無法推算出年齡</label>
                <label><input type="radio" name="q10" value="B"> 會算出小紅帽今年的年齡為負數，因此不合理</label>
                <label><input type="radio" name="q10" value="C"> 會算出小紅帽今年的年齡是分數，因此不合理</label>
                <label><input type="radio" name="q10" value="D"> 可以正確算出，無不合理的地方</label>
            </div>
        </div>

        <button type="button" class="btn-submit" onclick="submitQuiz()">送出答案並計算成績</button>
    </form>

    <div id="result-area">
        <p>您的成績為：</p>
        <div class="score-display" id="scoreDisplay">0 / 100</div>
        <p id="feedbackText"></p>
        <button type="button" class="btn-submit btn-mail" onclick="sendEmail()">將成績寄給老師 (019@tpjh.kh.edu.tw)</button>
    </div>
</div>

<script>
    // 正確答案設定
    const answers = {
        q1: 'B', // 2x+5
        q2: 'C', // -29
        q3: 'A', // 5
        q4: 'B', // -20
        q5: 'C', // -3
        q6: 'B', // -14
        q7: 'A', // 0
        q8: 'A', // x/30 = x/40 + 5
        q9: 'B', // 11
        q10: 'B' // 負數不合理
    };

    let calculatedScore = 0;

    function submitQuiz() {
        try {
            let score = 0;
            let pointsPerQuestion = 10;
            
            // 檢查姓名
            let nameField = document.getElementById('studentName');
            let name = nameField ? nameField.value.trim() : "";
            
            if (!name) {
                alert("請先輸入姓名！");
                nameField.focus();
                return;
            }

            // 計算分數
            for (let key in answers) {
                // 使用 querySelector 確保能抓到被選中的項目
                let selector = `input[name="${key}"]:checked`;
                let selectedOption = document.querySelector(selector);
                
                // 如果有選答案且答案正確
                if (selectedOption && selectedOption.value === answers[key]) {
                    score += pointsPerQuestion;
                }
            }

            calculatedScore = score;
            
            // 顯示結果
            document.getElementById('scoreDisplay').innerText = score + " 分";
            document.getElementById('result-area').style.display = 'block';
            
            let feedback = score >= 60 ? "恭喜及格！記得將成績寄給老師。" : "再接再厲！請將成績寄給老師。";
            document.getElementById('feedbackText').innerText = feedback;
            
            // 滾動到底部
            document.getElementById('result-area').scrollIntoView({behavior: 'smooth'});
            
        } catch (e) {
            console.error("發生錯誤:", e);
            alert("計算成績時發生錯誤，請重新整理頁面再試一次。");
        }
    }

    function sendEmail() {
        let name = document.getElementById('studentName').value;
        let cls = document.getElementById('studentClass').value;
        let no = document.getElementById('studentNo').value;
        
        if (!name) { alert("請輸入姓名"); return; }

        let subject = `數學測驗成績回報 - ${cls}班 ${name}`;
        let body = `老師您好，\n\n我是 ${cls} 班 ${no} 號 ${name}。\n我在「七年級數學科第三次定期評量」線上測驗中獲得了：\n\n【 ${calculatedScore} 分 】\n\n請老師查收，謝謝。`;

        // 建立 mailto 連結
        let mailtoLink = `mailto:019@tpjh.kh.edu.tw?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        
        // 開啟郵件軟體
        window.location.href = mailtoLink;
    }
</script>

</body>
</html>
